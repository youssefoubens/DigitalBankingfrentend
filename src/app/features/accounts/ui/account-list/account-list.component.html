<div class="account-list-container p-4 bg-light rounded-3 shadow-sm">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="mb-0 text-primary">
        <i class="bi bi-bank me-2"></i>Bank Accounts
      </h2>
      <p class="text-muted mb-0" *ngIf="accounts.length > 0">
        Showing {{ (currentPage - 1) * itemsPerPage + 1 }}-{{ Math.min(currentPage * itemsPerPage, accounts.length) }} of {{ accounts.length }} accounts
      </p>
    </div>
    <div>
      <div class="input-group mb-2" *ngIf="accounts.length > 0">
        <span class="input-group-text bg-white"><i class="bi bi-search"></i></span>
        <input 
          type="text" 
          class="form-control" 
          placeholder="Search accounts..." 
          [(ngModel)]="searchTerm"
          (input)="filterAccounts()"
        >
      </div>
      <a routerLink="/accounts/new" class="btn btn-primary">
        <i class="bi bi-plus-circle me-1"></i> Create Account
      </a>
    </div>
  </div>

  <div class="card border-0 shadow" *ngIf="filteredAccounts.length > 0">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th class="ps-4" (click)="sort('accountNumber')">
                Account Number 
                <i class="bi" [class.bi-arrow-up]="sortColumn === 'accountNumber' && sortDirection === 'asc'" 
                  [class.bi-arrow-down]="sortColumn === 'accountNumber' && sortDirection === 'desc'"></i>
              </th>
              <th (click)="sort('type')">
                Type 
                <i class="bi" [class.bi-arrow-up]="sortColumn === 'type' && sortDirection === 'asc'" 
                  [class.bi-arrow-down]="sortColumn === 'type' && sortDirection === 'desc'"></i>
              </th>
              <th (click)="sort('balance')">
                Balance 
                <i class="bi" [class.bi-arrow-up]="sortColumn === 'balance' && sortDirection === 'asc'" 
                  [class.bi-arrow-down]="sortColumn === 'balance' && sortDirection === 'desc'"></i>
              </th>
              <th>Status</th>
              <th class="text-end pe-4">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let account of pagedAccounts" class="account-row" [class.table-primary]="account.balance >= 10000">
              <td class="ps-4 fw-medium">
                <span class="d-block">{{ account.accountNumber }}</span>
                <small class="text-muted">{{ account.accountNumber || 'No name' }}</small>
              </td>
      
              <td>
                <span class="badge bg-light text-dark">
                  <i [class]="getAccountTypeIcon(account.type)"></i>
                  {{ account.type | titlecase }}
                </span>
              </td>
              <td [class.text-danger]="account.balance < 0" [class.text-success]="account.balance >= 0">
                {{ account.balance | currency:'USD':'symbol':'1.2-2' }}
                <div *ngIf="account.interestRate" class="text-muted small">
                  {{ account.interestRate }}% APR
                </div>
              </td>
              <td>
                <span [class]="'badge ' + getStatusBadgeClass(account.status)">
                  {{ account.status | titlecase }}
                </span>
                <div *ngIf="account.lastActivity" class="text-muted small">
                  Last activity: {{ account.lastActivity | date:'shortDate' }}
                </div>
              </td>
              <td class="text-end pe-4">
                <div class="btn-group btn-group-sm" role="group">
                  <a [routerLink]="['/accounts', account.id]" class="btn btn-outline-primary" title="View Details">
                    <i class="bi bi-eye"></i>
                  </a>
                  <a [routerLink]="['/accounts', account.id, 'edit']" class="btn btn-outline-secondary" title="Edit">
                    <i class="bi bi-pencil"></i>
                  </a>
                  <button class="btn btn-outline-danger" title="Delete" (click)="confirmDelete(account)">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Empty state -->
  <div *ngIf="filteredAccounts.length === 0" class="text-center py-5">
    <i class="bi bi-wallet2 text-muted" style="font-size: 3rem;"></i>
    <h4 class="mt-3">No accounts found</h4>
    <p class="text-muted" *ngIf="searchTerm">
      No accounts match your search for "{{ searchTerm }}". Try a different search term.
    </p>
    <p class="text-muted" *ngIf="!searchTerm">
      You don't have any accounts yet. Create your first account to get started.
    </p>
    <a routerLink="/accounts/new" class="btn btn-primary mt-2">
      <i class="bi bi-plus-circle me-1"></i> Create Account
    </a>
  </div>

<!-- Temporarily remove *ngIf to test -->
<!-- Replace your current pagination-controls with this -->
<div class="mt-3 d-flex justify-content-center" *ngIf="filteredAccounts.length > itemsPerPage">
  <nav aria-label="Page navigation">
    <ul class="pagination mb-0">
      <li class="page-item" [class.disabled]="currentPage === 1">
        <a class="page-link" (click)="onPageChange(currentPage - 1)" aria-label="Previous">
          <span aria-hidden="true">&laquo;</span>
        </a>
      </li>
      
      <!-- First page -->
      <li class="page-item" [class.active]="currentPage === 1">
        <a class="page-link" (click)="onPageChange(1)">1</a>
      </li>
      
      <!-- Show ellipsis if needed before current page -->
      <li class="page-item disabled" *ngIf="currentPage - 2 > 1">
        <span class="page-link">...</span>
      </li>
      
      <!-- Previous page if not first or second -->
      <li class="page-item" *ngIf="currentPage - 1 > 1 && currentPage - 1 < totalPages">
        <a class="page-link" (click)="onPageChange(currentPage - 1)">{{currentPage - 1}}</a>
      </li>
      
      <!-- Current page if not first or last -->
      <li class="page-item active" *ngIf="currentPage > 1 && currentPage < totalPages">
        <a class="page-link" (click)="onPageChange(currentPage)">{{currentPage}}</a>
      </li>
      
      <!-- Next page if not last or second last -->
      <li class="page-item" *ngIf="currentPage + 1 < totalPages">
        <a class="page-link" (click)="onPageChange(currentPage + 1)">{{currentPage + 1}}</a>
      </li>
      
      <!-- Show ellipsis if needed after current page -->
      <li class="page-item disabled" *ngIf="currentPage + 2 < totalPages">
        <span class="page-link">...</span>
      </li>
      
      <!-- Last page -->
      <li class="page-item" [class.active]="currentPage === totalPages" *ngIf="totalPages > 1">
        <a class="page-link" (click)="onPageChange(totalPages)">{{totalPages}}</a>
      </li>
      
      <li class="page-item" [class.disabled]="currentPage === totalPages">
        <a class="page-link" (click)="onPageChange(currentPage + 1)" aria-label="Next">
          <span aria-hidden="true">&raquo;</span>
        </a>
      </li>
    </ul>
  </nav>
</div>
  
  <!-- Delete confirmation modal -->
  <div class="modal fade" id="deleteAccountModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Confirm Deletion</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete account {{ accountToDelete?.accountNumber }} ({{ accountToDelete?.accountNumber || 'No name' }})?
          <div class="alert alert-warning mt-3">
            <i class="bi bi-exclamation-triangle me-2"></i>
            This action cannot be undone. All transaction history for this account will be permanently deleted.
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" (click)="deleteAccount()">
            <i class="bi bi-trash me-1"></i> Delete Account
          </button>
        </div>
      </div>
    </div>
  </div>
</div>